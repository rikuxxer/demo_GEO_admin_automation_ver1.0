# Excelテンプレート ヘッダー色分け仕様

## 概要
Excel一括登録テンプレートのヘッダー行に色を適用し、必須項目と任意項目を視覚的に区別できるようにしました。

## 色分けルール

### 🔴 赤色ヘッダー（薄い赤: #FFCCCC）
**必須項目** - 入力必須のフィールド

### ⚪ グレーヘッダー（薄いグレー: #E8E8E8）
**任意項目** - 空欄でもOKのフィールド

## 各シートの色分け

### シート2: 案件情報

| 列名 | 色 | 必須/任意 |
|------|------|----------|
| 広告主名 | 🔴 赤 | 必須 |
| 代理店名 | ⚪ グレー | 任意 |
| 訴求内容 | 🔴 赤 | 必須 |
| 配信開始日 | 🔴 赤 | 必須 |
| 配信終了日 | 🔴 赤 | 必須 |
| 備考 | ⚪ グレー | 任意 |

### シート3: セグメント設定

| 列名 | 色 | 必須/任意 |
|------|------|----------|
| セグメント名 | 🔴 赤 | 必須 |
| 配信先 | 🔴 赤 | 必須 |
| 配信範囲 | 🔴 赤 | 必須 |
| 配信期間 | 🔴 赤 | 必須 |
| 対象者 | 🔴 赤 | 必須 |
| 検知回数 | 🔴 赤 | 必須 |
| 検知時間 開始 | ⚪ グレー | 任意 |
| 検知時間 終了 | ⚪ グレー | 任意 |
| 滞在時間 | ⚪ グレー | 任意 |
| AdsアカウントID | ⚪ グレー | 任意 |

### シート4: 地点リスト

| 列名 | 色 | 必須/任意 | 備考 |
|------|------|----------|------|
| どのセグメント？ | 🔴 赤 | 必須 | セグメント名を参照 |
| 地点の名前 | 🔴 赤 | 必須 | POI名 |
| 住所 | 🔴 赤 | 必須 | または緯度経度 |
| 緯度 | ⚪ グレー | 任意 | 住所から自動取得可 |
| 経度 | ⚪ グレー | 任意 | 住所から自動取得可 |

### シート5: 選択肢リスト

| 列名 | 色 | 備考 |
|------|------|------|
| すべてのヘッダー | ⚪ グレー | 参照用シート |

## 実装詳細

### スタイル設定コード

```typescript
// 必須項目のヘッダースタイル
{
  fill: { fgColor: { rgb: 'FFCCCC' } }, // 薄い赤色
  font: { bold: true, color: { rgb: '000000' } },
  alignment: { wrapText: true, vertical: 'center', horizontal: 'center' }
}

// 任意項目のヘッダースタイル
{
  fill: { fgColor: { rgb: 'E8E8E8' } }, // 薄いグレー
  font: { bold: true, color: { rgb: '000000' } },
  alignment: { wrapText: true, vertical: 'center', horizontal: 'center' }
}
```

### セル指定方法

```typescript
// XLSXライブラリを使用したセルアドレスの取得
const cellAddress = XLSX.utils.encode_cell({ r: 0, c: col });
ws[cellAddress].s = { /* スタイル */ };
```

## ユーザーへの説明

### 入力ガイドシート（シート1）に記載

```
⚠️ 注意事項
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

・赤色のヘッダー = 必須項目（必ず入力）
・グレーのヘッダー = 任意項目（空欄OK）
・サンプル行は削除して入力してください
・⑤選択肢リストシートは編集しないでください
```

## メリット

### 1. **視認性の向上**
- 必須項目が一目で分かる
- 入力漏れを防止

### 2. **ユーザビリティの改善**
- 色で判断できるため、説明文を読まなくても理解可能
- 入力時の迷いを軽減

### 3. **エラー削減**
- 必須項目の入力忘れを防止
- バリデーションエラーの事前回避

## 今後の拡張案

### 1. データ検証ルールとの連動
- 必須セルに入力規則を追加
- 空欄の場合にExcel上でもエラー表示

### 2. 条件付き書式の追加
- 入力されたセルの背景色を変更
- 未入力の必須セルを強調表示

### 3. プルダウンセルの色分け
- 選択肢から選ぶセルを青色に
- 自由入力セルと区別

## 関連ファイル

- `/utils/excelTemplateGenerator.ts` - テンプレート生成ロジック
- `/utils/excelParser.ts` - Excel読み込み・バリデーション
- `/components/BulkImport.tsx` - 一括登録UI
- `/components/BulkImportEditor.tsx` - データ編集UI
