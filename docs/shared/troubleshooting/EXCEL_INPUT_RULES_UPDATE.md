# Excelå…¥åŠ›è¦å‰‡ã¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®æ›´æ–°

## ðŸ“‹ å¤‰æ›´å†…å®¹

åŠå¾„ã®å…¥åŠ›ç¯„å›²ã‚’0-10000ã«æ‹¡å¼µã—ã€è‡ªç”±å…¥åŠ›ã«å¯¾å¿œã—ã¾ã—ãŸã€‚

## å®Œäº†ã—ãŸå¤‰æ›´

### 1. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®å…¥åŠ›è¦å‰‡

- âœ… `PoiForm.tsx`ã«0-10000ã®è‡ªç”±å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ 
- âœ… ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆ0-10000ã®ç¯„å›²ãƒã‚§ãƒƒã‚¯ï¼‰
- âœ… ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡æ™‚ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
- âœ… ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¡¨ç¤º

### 2. Excelãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®å…¥åŠ›è¦å‰‡

- âœ… `excelTemplateGenerator.ts`ã®é…ä¿¡ç¯„å›²ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æ›´æ–°
- âœ… æ•°å€¤å…¥åŠ›è¦å‰‡ï¼ˆ0-10000ï¼‰ã‚’è¨­å®š
- âœ… ãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ï¼ˆ"500m"ãªã©ï¼‰ã‚‚ãƒ‘ãƒ¼ã‚µãƒ¼å´ã§å‡¦ç†å¯èƒ½

**å¤‰æ›´å‰:**
```typescript
// å›ºå®šãƒªã‚¹ãƒˆã®ã¿
row.getCell(3).dataValidation = { 
  type: 'list', 
  formulae: ['"50m,100m,...,10000m"'] 
};
```

**å¤‰æ›´å¾Œ:**
```typescript
// 0-10000ã®ç¯„å›²ã§è‡ªç”±å…¥åŠ›å¯èƒ½
row.getCell(3).dataValidation = {
  type: 'whole',
  operator: 'between',
  formulae: [0, 10000],
  allowBlank: true,
  showErrorMessage: true,
  error: '0-10000ã®ç¯„å›²ã§å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆä¾‹: 500 ã¾ãŸã¯ 500mï¼‰',
  errorStyle: 'warning'
};
```

### 3. Excelãƒ‘ãƒ¼ã‚µãƒ¼ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

- âœ… `excelParser.ts`ã®é…ä¿¡ç¯„å›²ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ›´æ–°
- âœ… æ•°å€¤ã®ã¿ï¼ˆä¾‹: "500"ï¼‰ã¨"æ•°å€¤m"å½¢å¼ï¼ˆä¾‹: "500m"ï¼‰ã®ä¸¡æ–¹ã«å¯¾å¿œ
- âœ… 0-10000ã®ç¯„å›²ãƒã‚§ãƒƒã‚¯ã‚’è¿½åŠ 

**å¤‰æ›´å‰:**
```typescript
if (/^\d+m$/.test(rStr)) segment.designated_radius = rStr;
else errors.push({ message: 'ã€Œ50mã€ã®ã‚ˆã†ãªå½¢å¼ã§å…¥åŠ›ã—ã¦ãã ã•ã„' });
```

**å¤‰æ›´å¾Œ:**
```typescript
const numMatch = rStr.match(/^(\d+)$/);
const mMatch = rStr.match(/^(\d+)m$/);

if (numMatch) {
  const radiusValue = parseInt(numMatch[1], 10);
  if (radiusValue >= 0 && radiusValue <= 10000) {
    segment.designated_radius = `${radiusValue}m`; // "m"ã‚’ä»˜ã‘ã¦ä¿å­˜
  } else {
    errors.push({ message: 'é…ä¿¡ç¯„å›²ã¯0-10000ã®ç¯„å›²ã§å…¥åŠ›ã—ã¦ãã ã•ã„' });
  }
} else if (mMatch) {
  const radiusValue = parseInt(mMatch[1], 10);
  if (radiusValue >= 0 && radiusValue <= 10000) {
    segment.designated_radius = rStr;
  } else {
    errors.push({ message: 'é…ä¿¡ç¯„å›²ã¯0-10000ã®ç¯„å›²ã§å…¥åŠ›ã—ã¦ãã ã•ã„' });
  }
} else {
  errors.push({ message: 'é…ä¿¡ç¯„å›²ã¯0-10000ã®æ•°å€¤ã€ã¾ãŸã¯ã€Œ500mã€ã®ã‚ˆã†ãªå½¢å¼ã§å…¥åŠ›ã—ã¦ãã ã•ã„' });
}
```

## å¯¾å¿œçŠ¶æ³

| é …ç›® | çŠ¶æ…‹ | èª¬æ˜Ž |
|------|------|------|
| ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å…¥åŠ›è¦å‰‡ | å®Œäº† | 0-10000ã®è‡ªç”±å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ  |
| ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ | å®Œäº† | 0-10000ã®ç¯„å›²ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè£… |
| Excelãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå…¥åŠ›è¦å‰‡ | å®Œäº† | 0-10000ã®æ•°å€¤å…¥åŠ›è¦å‰‡ã‚’è¨­å®š |
| Excelãƒ‘ãƒ¼ã‚µãƒ¼ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ | å®Œäº† | 0-10000ã®ç¯„å›²ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè£… |
| ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆå‡ºåŠ›ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ | å®Œäº† | setting_flagã«å¿œã˜ãŸå¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒã‚§ãƒƒã‚¯ |

## ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰

- `500` â†’ æ­£å¸¸ï¼ˆ0-10000ã®ç¯„å›²å†…ï¼‰
- `10000` â†’ æ­£å¸¸ï¼ˆæœ€å¤§å€¤ï¼‰
- `0` â†’ æ­£å¸¸ï¼ˆæœ€å°å€¤ï¼‰
- `10001` â†’ ã‚¨ãƒ©ãƒ¼ï¼ˆç¯„å›²å¤–ï¼‰
- `-1` â†’ ã‚¨ãƒ©ãƒ¼ï¼ˆç¯„å›²å¤–ï¼‰

### Excelãƒ‘ãƒ¼ã‚µãƒ¼

- `"500"` â†’ `"500m"`ã¨ã—ã¦ä¿å­˜
- `"500m"` â†’ `"500m"`ã¨ã—ã¦ä¿å­˜
- `"10000"` â†’ `"10000m"`ã¨ã—ã¦ä¿å­˜
- `"10000m"` â†’ `"10000m"`ã¨ã—ã¦ä¿å­˜
- `"10001"` â†’ ã‚¨ãƒ©ãƒ¼ï¼ˆç¯„å›²å¤–ï¼‰
- `"10001m"` â†’ ã‚¨ãƒ©ãƒ¼ï¼ˆç¯„å›²å¤–ï¼‰
- `"abc"` â†’ ã‚¨ãƒ©ãƒ¼ï¼ˆç„¡åŠ¹ãªå½¢å¼ï¼‰

## æ³¨æ„äº‹é …

1. **Excelã®å…¥åŠ›è¦å‰‡**: æ•°å€¤å…¥åŠ›è¦å‰‡ï¼ˆ0-10000ï¼‰ã‚’è¨­å®šã—ã¦ã„ã¾ã™ãŒã€ãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ï¼ˆ"500m"ãªã©ï¼‰ã‚‚ãƒ‘ãƒ¼ã‚µãƒ¼å´ã§å‡¦ç†å¯èƒ½ã§ã™ã€‚

2. **ãƒ‡ãƒ¼ã‚¿å½¢å¼ã®çµ±ä¸€**: ãƒ‘ãƒ¼ã‚µãƒ¼å´ã§æ•°å€¤ã®ã¿ã®å…¥åŠ›ï¼ˆä¾‹: "500"ï¼‰ã‚’"500m"å½¢å¼ã«å¤‰æ›ã—ã¦ä¿å­˜ã—ã¾ã™ã€‚

3. **æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã¨ã®äº’æ›æ€§**: æ—¢å­˜ã®"50m"å½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ã‚‚å¼•ãç¶šãå‡¦ç†å¯èƒ½ã§ã™ã€‚

