# 半径入力範囲拡張（0-10000）の更新完了チェックリスト

## ✅ 完了した更新

### 1. フロントエンドコンポーネント

- ✅ **PoiForm.tsx**
  - 0-10000の自由入力フィールドを追加
  - リアルタイムバリデーション（0-10000の範囲チェック）
  - フォーム送信時のバリデーション
  - エラーメッセージの表示

- ✅ **SegmentFormCommonConditions.tsx**
  - ドロップダウンに加えて0-10000の自由入力フィールドを追加
  - リアルタイムバリデーション（0-10000の範囲チェック）
  - エラーメッセージの表示

- ✅ **PoiTable.tsx**
  - 編集時に0-10000の自由入力フィールドを追加
  - リアルタイムバリデーション（0-10000の範囲チェック）
  - エラーメッセージの表示

- ✅ **ProjectDetail.tsx**
  - 抽出条件設定ポップアップに0-10000の自由入力フィールドを追加
  - リアルタイムバリデーション（0-10000の範囲チェック）
  - エラーメッセージの表示

### 2. Excel関連

- ✅ **excelTemplateGenerator.ts**
  - Excelテンプレートの配信範囲フィールドを更新
  - 数値入力規則（0-10000）を設定
  - テキスト形式（"500m"など）もパーサー側で処理可能

- ✅ **excelParser.ts**
  - 配信範囲バリデーションを更新
  - 数値のみ（例: "500"）と"数値m"形式（例: "500m"）の両方に対応
  - 0-10000の範囲チェックを追加

### 3. スプレッドシート出力関連

- ✅ **spreadsheetValidation.ts**
  - setting_flag=4, 7, 8の半径バリデーション範囲を0-10000に修正
  - エラーメッセージを更新

- ✅ **googleSheets.ts**
  - SheetRowインターフェースをエクスポート（spreadsheetValidation.tsで使用）

### 4. バックエンド

- ✅ **BigQueryスキーマ**
  - `designated_radius`フィールドは既に`STRING`型のため、変更不要
  - 0-10000の数値文字列（例: "500m", "10000m"）を保存可能

## 📋 確認済み項目

### データ形式の一貫性

- ✅ フロントエンド: "500m"形式で保存
- ✅ Excelパーサー: "500" → "500m"に変換して保存
- ✅ スプレッドシート出力: 数値のみ（"500"）として出力
- ✅ BigQuery: "500m"形式で保存（既存データと互換性あり）

### バリデーション範囲

- ✅ フロントエンド: 0-10000の範囲チェック
- ✅ Excelパーサー: 0-10000の範囲チェック
- ✅ スプレッドシートバリデーション: 0-10000の範囲チェック（setting_flag=4, 7, 8）

### 既存データとの互換性

- ✅ 既存の"50m"形式のデータも引き続き処理可能
- ✅ BigQueryスキーマ変更不要（STRING型のため）

## 🔍 テスト推奨項目

1. **フロントエンド入力テスト**
   - [ ] PoiFormで0-10000の範囲で入力可能か
   - [ ] SegmentFormCommonConditionsで0-10000の範囲で入力可能か
   - [ ] PoiTableの編集で0-10000の範囲で入力可能か
   - [ ] ProjectDetailの抽出条件設定で0-10000の範囲で入力可能か
   - [ ] 範囲外（-1, 10001）の入力でエラーが表示されるか

2. **Excel一括登録テスト**
   - [ ] Excelテンプレートで0-10000の範囲で入力可能か
   - [ ] "500"形式と"500m"形式の両方が処理されるか
   - [ ] 範囲外の入力でエラーが表示されるか

3. **スプレッドシート出力テスト**
   - [ ] setting_flag=4, 7, 8で半径が0-10000の範囲でバリデーションされるか
   - [ ] 範囲外の入力でエラーが表示されるか

## 📝 注意事項

1. **Excelの入力規則**: 数値入力規則（0-10000）を設定していますが、テキスト形式（"500m"など）もパーサー側で処理可能です。

2. **データ形式の統一**: パーサー側で数値のみの入力（例: "500"）を"500m"形式に変換して保存します。

3. **既存データとの互換性**: 既存の"50m"形式のデータも引き続き処理可能です。

4. **バックエンドバリデーション**: フロントエンドとExcelパーサーでバリデーションを行っているため、バックエンドでの追加バリデーションは不要です（BigQueryのスキーマがSTRING型のため）。

